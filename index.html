<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>S&P 500 and NASDAQ Data</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f5f5f5;
      color: #333;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
      padding: 20px;
    }
    .container {
      background-color: white;
      padding: 20px;
      margin: 10px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      text-align: center;
      width: 300px;
    }
    .data-item {
      margin: 10px 0;
    }
  </style>
</head>
<body>
  <div class="container" id="sp500-container">
    <h1>S&P 500 (SPY)</h1>
    <div class="data-item">
      <strong>Current Price:</strong> <span id="spy-current">Loading...</span>
    </div>
    <div class="data-item">
      <strong>Top Price (10Y):</strong> <span id="spy-top">Loading...</span>
    </div>
    <div class="data-item">
      <strong>% Change from Top:</strong> <span id="spy-change">Loading...</span>
    </div>
  </div>

  <div class="container" id="nasdaq-container">
    <h1>NASDAQ (QQQ)</h1>
    <div class="data-item">
      <strong>Current Price:</strong> <span id="qqq-current">Loading...</span>
    </div>
    <div class="data-item">
      <strong>Top Price (10Y):</strong> <span id="qqq-top">Loading...</span>
    </div>
    <div class="data-item">
      <strong>% Change from Top:</strong> <span id="qqq-change">Loading...</span>
    </div>
  </div>

  <script>
    const apiKey = "6E4VML159PQTJM5R"; // ðŸ”‘ Replace with your Alpha Vantage API key

    async function fetchData(symbol, prefix) {
      const apiUrl = `https://www.alphavantage.co/query?function=TIME_SERIES_DAILY&symbol=${symbol}&apikey=${apiKey}`;
      try {
        const response = await fetch(apiUrl);
        const data = await response.json();

        if (!data["Time Series (Daily)"]) {
          throw new Error("Invalid response from Alpha Vantage (maybe API limit hit).");
        }

        const timeSeries = data["Time Series (Daily)"];
        const dates = Object.keys(timeSeries).sort(); // oldest â†’ newest
        const prices = dates.map(d => parseFloat(timeSeries[d]["4. close"]));

        const currentPrice = prices[prices.length - 1];
        const topPrice = Math.max(...prices);
        const pctChange = ((currentPrice - topPrice) / topPrice * 100).toFixed(2);

        document.getElementById(`${prefix}-current`).textContent = currentPrice.toFixed(2);
        document.getElementById(`${prefix}-top`).textContent = topPrice.toFixed(2);
        document.getElementById(`${prefix}-change`).textContent = `${pctChange}%`;
      } catch (err) {
        console.error(`Error fetching ${symbol}:`, err);
        document.getElementById(`${prefix}-current`).textContent = "Error";
        document.getElementById(`${prefix}-top`).textContent = "Error";
        document.getElementById(`${prefix}-change`).textContent = "Error";
      }
    }

    // Fetch both SPY (S&P 500) and QQQ (NASDAQ-100)
    fetchData("SPY", "spy");
    fetchData("QQQ", "qqq");
  </script>
</body>
</html>
